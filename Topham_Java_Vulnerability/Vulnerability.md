# All Vulnerabilities are located in the YuchResource.java file
# Second submission to try Java - Other Python version of this assignment submitted to 2VU.

#  Setup 
1. Disable CSRF
public class SecurityConfiguration: turned off csrf by the following method http.csrf().disable();
2. Setup cookies
curl http://localhost:8080/login -c cookie.txt
curl http://localhost:8080/login -b cookie.txt
curl -b cookies.txt -c cookies.txt -XGET http://localhost:8080/login -F "username=admin" -F "password=admin"
curl -b cookies.txt -c cookies.txt -XPOST http://localhost:8080/api/authentication -F "username=admin" -F "password=admin"

# Input Details 
1. Classes and interfaces used
    - YuchResource: The control that takes in the input from the paths
    - Yuch Java: Factory for Yuchs
    - YuchRepository: NA
    - YuchService: Implements the methods that creates the calls to the database
    - Yuch_.java: Setups the columns in the database
            Noteworthy classes
               - JpaReposiitory
               - ResponseEntity
               - HttpEntity
2. Input used 
- I used the eS field located in the Yuch.Java file


3. Created vulnerabilities

 - Vulnerability 1
 Vulnerability 1 is an html injection attack this could be used for XSS. In this vulnerability you should be able to insert javascript into the URL that will appear in the browser. This is achieved through the MediaType.Text_html_value producer.

 - Vulnerability 2
  In this method I created a runtime vulnerability injection attack and it works by concatinating the unsanitizaed "get.eS" field into the exec command. The method takes a ID_Holder script that an application might have in place for user local file storage and create a directory on the users computer by passing in a shell crafted input into the eS field. The .exec command is a direct attack to the shell, this should return  a 0 in the result variable if successful



# Execution

# Vulnerability 1: Injection Attack

The vulnerability can be exploited by following the steps below:

1. Using your browser go to the following URL: http://localhost:8080
2. Log in username: Admin Password: Admin
3. In the URL Input one of the following
    -Encoded for URL http://localhost:8080/api/injection?script=%3Cscript%3Ealert(%27Injection%20Complete%27)%3B%3C%2Fscript%3E
    - Decoded http://localhost:8080/api/injection?script=<script>alert('Injection Complete');</script>
4. Use Curl- 
    1. Setup cookies
    2. curl -b cookies.txt -c cookies.txt -XGET http://localhost:8080/api/injection
   

# Vulnerability 2 Run Time Execution:
1. Using your browser go to the following URL: http://localhost:8080
2. Log in username: Admin Password: Admin
3. Set the Yuck eS field to /injectedfolder
4. Go to the following URL http://localhost:8080/api/rt
    4. Use Curl- 
    1. Setup cookies
    2. curl -b cookies.txt -c cookies.txt -XGET http://localhost:8080/api/rt




# Code Snippets

http://localhost:8080/api/yuches

- Brings back all records
curl -b cookies.txt -c cookies.txt -XGET http://localhost:8080/api/inj/Bacon%20Designer -F "username=admin" -F "password=admin"

# Errors:

1. Vulnerability 1: 
Issue 1: 
When going to 
http://localhost:8080/api/injection?script=<script>alert('Injection Complete');</script>
The browser comes back with an error, this does not look like Chromes XSS protection

issue 2: 
When using curl I get "syntax error near unexpected token `(' "


2. Vulnerability 2 is giving the following error
issue 1:
{
"type": "https://www.jhipster.tech/problem/problem-with-message",
"title": "Internal Server Error",
"status": 500,
"detail": "Cannot run program \"mkdir\": CreateProcess error=2, The system cannot find the file specified",
"path": "/api/rt",
"message": "error.http.500"
}
